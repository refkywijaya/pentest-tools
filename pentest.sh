#!/bin/bash

echo "--[ Pentest tool v1.0-beta (www.backboxindonesia.or.id) ]--"
echo -n "[?] Input your target : "
read target
echo "[+] Creating folder.."
mkdir $target >> /dev/null
cd $target
echo "[*] Get Whois.."
whois $target > $target.whois
echo "[*] Dns record.."
dig $target ANY | grep -v ";" | grep -v "^$" | sort > $target.dns
echo "[*] Ip range on the network.."
irange=$(host $target | head -1 | awk '{print $4}' | cut -d "." -f 1,2,3)
seq 1 255 | while read dw; do
	tim=1
	ping -c 1 $irange.$dw & cpid=$! 
	(sleep $tim; kill -9 $cpid) &
	wpid=$!
	wait $cpid &
	kill $wpid >/dev/null 2>&1 &
done  2>&1 | grep "bytes from" | awk '{print $4}' | cut -d : -f1 | sort -u >> $target.range
cat $target.range | while read sas; do 
	tim=1
	nc -v -z $sas 80 & cpid=$!
	(sleep $tim; kill -9 $cpid) &
        wpid=$!
        wait $cpid &
        kill $wpid >/dev/null 2>&1 &
done 2>&1 | grep "succeeded" >> $target.range
echo "[*] Get Subdomain.."
curl http://pastebin.com/raw/3TTBYYXb -s | while read iid; do
	resp=$(curl $iid.$target -I -s | head -1 | awk '{print $2}');
	if [[ "$resp" == "200" ]]; then
		echo -e "$iid.$target \t$(host $iid.$target | head -1 | awk '{print $4}')" >> $target.subdomain
	fi
done
echo "[*] Reverse Domain (yougetsignal).."
curl -d "remoteAddress=$target&ket=" http://domains.yougetsignal.com/domains.php -s | sed "s/\"/\n/g" | grep "\." | sort -u > $target.reverse
echo "[*] Scanning port.."
nmap $target > $target.nmap
echo "[*] Enum wayback.."
curl http://wayback.archive.org/web/*/$target/* -s | grep "</a>" | grep "$target" | cut -d ">" -f2 | cut -d "<" -f1 | sort -u > $target.wayback
echo "[*] Scanning directory.."
dirsearch -u $target -e php > $target.dirsearch 
cd ..
echo "[!] Have a nice day ;)"
